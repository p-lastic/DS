# Определение стоимости автомобилей  
Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. Предоставлены исторические данные: технические характеристики, комплектации и цены автомобилей. Нужно построить модель для определения стоимости. RMSE должно быть не больше 2500.   
Заказчику важны:  
- качество предсказания;  
- скорость предсказания;  
- время обучения.

**Цель проекта:** научить модель прогнозировать рыночную стоимость автомобиля.  
  
**Ход работы:**    
    1. Загрузка данных и изучение общей информации о них;    
    2. Предобработка данных - проверка на дубликаты, соответствие типов данных, работа с пропусками и аномалиями;    
    3. Создание признаков для обучения модели, деление данных на выборки и кодирование;       
    4. Обучение моделей с подбором параметров;    
    5. Анализ моделей по критериям заказчика;  
    6. Тестирование лучшей модели. 

## Отчет по проделанной работе
1. Загружены данные и удалены дубликаты, данные о пользователях, ненужные для анализа и обучения моделей.
2. Пропуски в категориальных данных заполнены обозначением "неизвестно". Исследованы аномалии в признаке мощности. Неизвестно, откуда существует такое количество машин с 0 л.с. в базе, возможно, так помечались неработающие машины, или пользователи вводили так по ошибке. Проверено, отличается ли цена у машин со значением 0 и не 0 в параметре power.
   
   ![image](https://github.com/p-lastic/DS/assets/140812604/ea5ad850-ba7c-4639-a4d1-0fe96235ac64) ![image](https://github.com/p-lastic/DS/assets/140812604/ea178433-259a-4602-b25f-e056f06ce0ed)

Поскольку машины с аномально низким значением в мощности могут стоить и дешево, и дорого, как и машины с обычной мощностью, нельзя сделать вывод, что 0 - обозначение, например, неработающей машины, и скорее всего это значение по ошибке вводил пользователь. 
Объем аномалий в мощности велик относительно выборки, поэтому их нельзя удалить. Они заменены медианным значением по модели машины.  
3. Типы данных преведены к соответствующим.  
4. Из признака "дата создания объявления" выделены новые признаки - день недели, месяц, год.    
5. Данные разбиты на выборки и закодированы - прямым кодированием для линейных моделей и порядковым для остальных.  
6. Обучены 3 модели с предварительным подбором гиперпараметров - линейная регрессия, дерево решений (max_depth = 12) и LGBMRegressor (learning_rate=0.1, max_depth=21, n_estimators=91).  
Характеристики полученных моделей занесены в таблицу:  

Модель DecisionTree(max_depth=12) показывает лучшее качество и скорость обучения, по времени предсказания уступает Линейной регрессии почти в 4 раза, которая так же подходит под критерий качества, но обучается относительно долго. Исходя из критериев заказчика, лучше подходит модель DecisionTree.  
  
**Рекомендации заказчику:** для использования в сервисе определения рыночной стоимости автомобиля рекомендуется модель DecisionTree(max_depth=12), поскольку показала лучшее качество и была протестирована, однако стоит учесть, что время предсказания в 4 раза больше, чем у модели Линейной регрессии, которая так же подходит под критерий качества, но обучается долго. 
Дополнительно: доработать сервис, чтобы пользователь мог ввести только данные, соответствующие действительности, например, установить рамки, чтобы модель работала в последствии корректно.  
