# Восстановление золота из руды
Задача - подготовить прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Предоставлены данные с параметрами добычи и очистки. 
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.  

**Цель проекта:** научить модель прогнозировать коэффициент восстановления золота из золотосодержащей руды.   
  
**Задачи:**   
- Исследовать изменение концентрации элементов на каждом этапе;
- Проанализировать распределения размеров гранул на обучающей и тестовой выборках;
- Исследованы суммарные концентрации.
  
**Ход работы:**    
  
    1. Изучение общей информации о данных;    
    2. Проверка формулы вычисления эффективности обогащения;  
    3. Подготовка выборок, работа с пропусками;        
    4. Проведение исследовательского анализа данных - классов, распределения, аномалий;    
    5. Создание функции для вычисления итоговой метрики *sMAPE*;  
    6. Обучение и проверка нескольких моделей;  
    7. Выбрать лучшую модель, её качество проверить на тестовой выборке.

## Отчет по проделанной работе  
1. Правильность формулы вычисления эффективности обогащения подтверждена.
2. Проведена предобработка данных, подготовлены выборки для дальнейшего обучения моделей - добавлены признаки из исходных данных и удалены лишние из тренировочной выборки. Пропущенные значения заполнены методом интерполяции и проверено отсутствие дубликатов.
3. Отслежены изменения концентрации металлов (Au, Ag, Pb) на различных этапах очистки - свинец и золото становятся концентрированнее после очисток - очищаются от сторонних примесей, концентрация серебра больше не становится, возможно, большая доля остается в "хвостах".  
   ![image](https://github.com/p-lastic/DS/assets/140812604/f5e7ebb1-97c0-45f9-b5e5-3d777994e053)
   
4. Были сопоставлены распределения размеров гранул сырья на обучающей и тестовой выборках. Проверено, что распределения сильно не отличаются друг от друга, и оценка модели не пострадает.  
![image](https://github.com/p-lastic/DS/assets/140812604/8aefcf92-c0fb-4cf4-824d-bf3fd79a608f)
  
5. Обучены модели линейной регрессии, древа решений и случайного леса с подобранными гиперпараметрами и оценено их качество кастомной метрикой в кросс-валидации.
Лучшие показатели выявлены у модели случаного леса, где для целевого признака rougher.output.recovery метрика составила 2.737 при параметрах max_depth= 5 и n_estimators= 40; и модель для final.output.recovery, метрика которой составила 2.557 при max_depth= 5 n_estimators= 50.
6. Модели, обученные для предсказания двух таргетов протестированы, и показатель итоговой метрики не стал больше, равен ..., модели не переобучены и эффективны.
   Цель проекта достигнута: построена и обучена модель, предсказывающая коэффициент восстановления золота из золотосодержащей руды. 
