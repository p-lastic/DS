# Отток клиентов Ниединогоразрыва.ком
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.  
  
**Цель проекта:** научить модель прогнозировать отток клиентов для оператора связи «Ниединогоразрыва.ком»  
  
**Ход работы:**    
    1. Изучение общей информации о данных;    
    2. Предобработка данных - проверка на дубликаты, соответствие типов данных;    
    3. Создание признаков для обучения модели;     
    4. Проведение исследовательского анализа данных - классов, распределения, аномалий;    
    5. Построение и обучение модели - решить задачу бинарной классификации (ушел/не ушел) с показателем метрики AUC-ROC не меньше 0.85  

## Отчет по проделанной работе
1. Была изучена общая информация о данных - размер выборки и данные признаки. Обнаружено, что выборки phone и internet меньшего размера. Не обнаружены пропуски.
2. Выполнена предобработка данных - проверка на дубликаты, приведение типов данных к соответстсвующим, устранение пробелов в данных о новых клиентах в признаке "всего потрачено на услуги", удалены признаки-идентификаторы и вызывающие утечку данных.
3. Создан целевой признак, явно указывающий на клиентов, расторгнувших договор и признак, указывающий на количество дней пользования услугами по договору.
4. Проведен исследовательский анализ данных:
   ![image](https://github.com/p-lastic/DS/assets/140812604/5b491494-5eda-4875-ad4d-6096c944ff77)

   1. Существует сильная зависимость между расходами за месяц, интернет сервисом и подключенными услугами; 
   2. Признак пола почти совсем ни на что не влияет, в том числе и на целевой признак; 
   3. У целевого признака нет выраженной зависимости с какими-либо признаками - максимальный коэффициент с количеством дней от начала договора - 0.37;
   ![image](https://github.com/p-lastic/DS/assets/140812604/89fe846e-75a6-43c2-b738-c8ede98969ce)

   4. Выявлен дисбаланс классов в целевом признаке - в выборке закрыли договор около 15 процентов клиентов;
   5. Больше половины клиентов договор заключают на месяц. Процент ушедших клиентов в этой категории меньше, чем среди договоров на год и на два. Но нужно принять во внимание, что это возможно потому, что пользуются услугами меньше года - большое количество новых клиентов, по истечению этого срока возможно договор закроют;
   6. В процентом соотношении ушедших меньше среди тех, кто получают электронный чек и чек на почту относительно двух других категорий;
   7. Чаще закрывают договор те, у кого есть партнер; 
   8. Больше 20-ти % клиентов не подключают интернет. Это не влияет на отток клиентов, как и тип используемого оптического волокна; 
   9. Каждую доп услугу подключает примерно треть клиентов. При этом среди тех кто подключил - ушедших столько же; 
   10. Подключающих многоканальную телефонию на треть меньше, но ушедших среди них больше; 
    ![image](https://github.com/p-lastic/DS/assets/140812604/d2bfe2ef-17ac-4668-a054-12af00606ddb)

   11. Четверть клиентов платит минимальную сумму в месяц - до 30 ден. ед.;
   12. Больше полутора тысяч новых клиентов - они пользуются услугами меньше полугода, это сказывается на общих тратах по клиенту;
5. Были подготовлены тренировочная и тестовая выборки для обучения модели. Закодированы данные для модели случайного леса. Данная модель не подошла по требуемым характеристикам. Построена  и обучена модель CatBoostClassifier со встроенным кодировщиком категориальных признаков с параметрами eval_metric='AUC', depth=5, learning_rate=0.04, iterations=1000, random_seed=220523. 
    
    На тренировочной выборке получена метрика AUC-ROC 0.89 что соответствует требованиям проекта. При тестировании модель показала результат 0.91 и accuracy 0.9
    ![image](https://github.com/p-lastic/DS/assets/140812604/0266d23f-d180-459a-9ce5-91e40d879404)

    
    Матрица ошибок показала, что модель почти с 50-ти процентой вероятностью правильно предскажет значение 1
   
   ![image](https://github.com/p-lastic/DS/assets/140812604/78bf9f79-8183-43d8-ac39-7a197954e529)

    
    Исследование важности признаков показало, что важнейшим является показатель количества дней действия договора.   
 
    ![image](https://github.com/p-lastic/DS/assets/140812604/d2d2c284-c714-4d8e-a30c-754b8d7ca5a9)

    
Тем самым была достигнута цель проекта - построить и обучить модель прогнозировать отток клиентов для оператора связи «Ниединогоразрыва.ком» - решить задачу бинарной классификации с показателем метрики AUC-ROC не меньше 0.85.  

Трудностью при выполнении задания можно назвать адекватный анализ категориальных признаков, зависимостей среди них. Чтобы эффективно решить данную задачу, потребовались советы тимлида и самостоятельное изучение и подбор дополнительных библиотек.  
  
Ключевыми шагами в данном проекте считаю предобработку данных, включающую создание новых признаков, а так же перебор параметров для обучения моделей для получения максимальных результатов. В отчете о ходе работы описаны результаты этих шагов.
